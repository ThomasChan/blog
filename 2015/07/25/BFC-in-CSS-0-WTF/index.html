<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>BFC in CSS(0) - WTF | 追客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="stylesheet" href="/css/app.css" type="text/css">
  <!-- <link rel='stylesheet' href='http://fonts.useso.com/css?family=Source+Code+Pro'> -->
</head>

<body>
  <nav class="app-nav">
  
      
        <a class="active" href="/.">home</a>
        

      
  
      
        <a href="/archives">archive</a>
      
  
      
        <a href="/atom.xml">rss</a>
      
  
</nav>

  <main class="post">
  <article>
  <h1 class="article-title">
    <a href="/2015/07/25/BFC-in-CSS-0-WTF/">BFC in CSS(0) - WTF</a>
  </h1>

  <section class="article-meta">
    <p class="article-date">July 25 2015</p>
  </section>

  <section class="article-entry">
    <p>看了<a href="http://www.sitepoint.com/understanding-block-formatting-contexts-in-css/" target="_blank" rel="external">Understanding Block Formatting Contexts in CSS</a>这篇文章，终于有点明白什么是BFC(Block Formatting Context)了。</p>
<h2 id="Normal_Flow"><a href="#Normal_Flow" class="headerlink" title="Normal Flow"></a>Normal Flow</h2><p><strong>下面这句话不要忽略啊。要不然很多事情就想不通</strong>。</p>
<blockquote>
<p>Boxes in the normal flow belong to a formatting context, which may be block or inline, but not both simultaneously. Block-level boxes participate in a block formatting context. Inline-level boxes participate in an inline formatting context.</p>
</blockquote>
<p>在normal flow中的盒子都是属于formatting context的！！什么意思？<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">p</span>&gt;</span> I am in the formatting context<span class="tag">&lt;/<span class="title">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">div</span>&gt;</span> I also belong to the formatting context<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>在上面的例子，<code>p</code>和<code>div</code>都是在<em>normal flow</em>里面的。并且，他们都是块级元素，所以他们参与了block formatting contexts。</p>
<p>那么，参与了BFC又会怎么样呢？</p>
<h2 id="Block_Formatting_Contexts"><a href="#Block_Formatting_Contexts" class="headerlink" title="Block Formatting Contexts"></a>Block Formatting Contexts</h2><p>下面的<a href="http://www.w3.org/TR/CSS21/visuren.html#block-formatting" target="_blank" rel="external">文档</a>定义了<em>在BFC中盒子是怎么排版的</em>:</p>
<blockquote>
<p>In a block formatting context, boxes are laid out one after the other, vertically, beginning at the top of a containing block. The vertical distance between two sibling boxes is determined by the ‘margin’ properties. Vertical margins between adjacent block-level boxes in a block formatting context collapse.</p>
</blockquote>
<p>在BFC中，盒子都是按垂直方向一个挨着一个排版的，从<em>containing block</em>的顶部开始。2个sibing boxed的<br>垂直方向的距离是由<code>margin</code>来决定的，但此时的2个盒子的<code>margin</code>是会<strong>collapse</strong>(坍塌？折叠？)</p>
<p>那到底是怎么collapse法，我们要怎样才能解决。</p>
<h2 id="BFC_u5F15_u8D77_u7684Collapse_Margins"><a href="#BFC_u5F15_u8D77_u7684Collapse_Margins" class="headerlink" title="BFC引起的Collapse Margins"></a>BFC引起的Collapse Margins</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">style</span>&gt;</span><span class="css"></span><br><span class="line">  <span class="tag">p</span> <span class="rules">&#123;</span><br><span class="line">    <span class="rule"><span class="attribute">margin</span>:<span class="value"> <span class="number">10px</span></span></span>;</span><br><span class="line">    <span class="rule"><span class="attribute">background-color</span>:<span class="value"> lightgreen</span></span>;</span><br><span class="line">  &#125;</span></span><br><span class="line"></span><span class="tag">&lt;/<span class="title">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">p</span>&gt;</span> Sibling 1 <span class="tag">&lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">p</span>&gt;</span> Sibling 2 <span class="tag">&lt;/<span class="title">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>上面的例子中，2个<code>p</code>的之间的<code>margin</code>只有<code>10px</code>而不是<code>20px(10 + 10)</code>。为什么？因为前面说过，</p>
<p>2个<code>p</code>都是在<em>normal flow</em>中，并且，他们是块级元素，所以他们会参与block formatting contexts。</p>
<p>又因为在BFC中，2个sibling element的垂直方面的<code>margin</code>会collapse！于是，结果取2者较大的那个。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">P</span><span class="pseudo">:last-child</span> <span class="rules">&#123;</span><br><span class="line">  <span class="rule"><span class="attribute">margin</span>:<span class="value"> <span class="number">20px</span></span></span>;</span><br><span class="line">&#125;</span></span><br></pre></td></tr></table></figure>
<p>这样一来，2个<code>p</code>垂直方向的<code>margin</code>就取<code>20</code>。因为20比10大。</p>
<p>那么，我们如何解决margin collapse呢？答案就是<strong>创建一个新的bfc</strong>。</p>
<p>为什么可以？因为前面的文档说过: <em>In a block formatting….</em>才会发生margin collapse。<br>也就是说，如果<strong>不在同一个bfc</strong>的话，那么就不会有margin collapse。因此，我们创建新的bfc就行了。</p>
<p>那么，怎样才能创建新的bfc呢？</p>
<h2 id="Create_a_New_BFC"><a href="#Create_a_New_BFC" class="headerlink" title="Create a New BFC"></a>Create a New BFC</h2><blockquote>
<p>Floats, absolutely positioned elements, block containers (such as inline-blocks, table-cells, and table-captions) that are not block boxes, and block boxes with ‘overflow’ other than ‘visible’ (except when that value has been propagated to the viewport) establish new block formatting contexts for their contents.</p>
</blockquote>
<p>通过上面的<a href="http://www.w3.org/TR/CSS21/visuren.html#block-formatting" target="_blank" rel="external">文档</a>，我们可以总结出以下的情况会创建出新的BFC:</p>
<ul>
<li><code>float</code>的值不为<code>none</code></li>
<li><code>position</code>的值不为<code>static</code>或者<code>relative</code>。</li>
<li><code>display</code>的值为<code>table-cell</code>, <code>table-caption</code>, <code>inline-block</code></li>
<li><code>overflow</code>的值不为<code>visible</code>。</li>
</ul>
<p>举个例子:<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">style</span>&gt;</span><span class="css"></span><br><span class="line">  <span class="class">.newBFC</span> <span class="rules">&#123;</span><br><span class="line">    <span class="rule"><span class="attribute">overflow</span>:<span class="value"> hidden</span></span>;</span><br><span class="line">  &#125;</span></span><br><span class="line"></span><span class="tag">&lt;/<span class="title">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"newBFC"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">p</span>&gt;</span>I am in the BFC created by my parent tag<span class="tag">&lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>上面例子中的<code>div</code>就创建了一个新的bfc。</p>
<p>所以，我们就可以解决margin collapse:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">style</span>&gt;</span><span class="css"></span><br><span class="line">  <span class="tag">p</span> <span class="rules">&#123;</span><br><span class="line">    <span class="rule"><span class="attribute">margin</span>:<span class="value"> <span class="number">10px</span></span></span>;</span><br><span class="line">    <span class="rule"><span class="attribute">background-color</span>:<span class="value"> lightgreen</span></span>;</span><br><span class="line">  &#125;</span></span><br><span class="line">  <span class="class">.newBFC</span> <span class="rules">&#123;</span><br><span class="line">    <span class="rule"><span class="attribute">overflow</span>:<span class="value"> hidden</span></span>;</span><br><span class="line">  &#125;</span></span><br><span class="line"></span><span class="tag">&lt;/<span class="title">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">p</span>&gt;</span> Sibling 1 <span class="tag">&lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"newBFC"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">p</span>&gt;</span> Sibling 2 <span class="tag">&lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="Wrap_up"><a href="#Wrap_up" class="headerlink" title="Wrap up"></a>Wrap up</h2><p>总的来说，BFC就是定义了块级元素是如何排版的。</p>
<p>另外，创建新的BFC可以解决一些问题。比如上面的<em>margin collapse</em>，还有更多的例子，我们下篇再说。</p>

  </section>
</article>

  <div class="sharing grid">
  <section class="profile grid-item grid">
    <img class="avatar" src="http://7xrcp8.com1.z0.glb.clouddn.com/avatar.png" alt="avatar" />
    <div class="grid-item">
      <p class="title"> 追客 </p>
      <p class="subtitle"> You are the JavaScript in my HTML </p>
    <div>
  </section>

  <section class="share-btns">
    <!-- <p> share it if you like it~ </p> -->
    <a
  class="twitter-share-button"
  data-size="large"
  data-via="DrakeLeung"
  href="https://twitter.com/intent/tweet?text=看了<a href="http://ww"
>
  Tweet
</a>

<script>
  window.twttr = (function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0],
    t = window.twttr || {};
  if (d.getElementById(id)) return t;
  js = d.createElement(s);
  js.id = id;
  js.src = "https://platform.twitter.com/widgets.js";
  js.async = true;
  fjs.parentNode.insertBefore(js, fjs);

  t._e = [];
  t.ready = function(f) {
    t._e.push(f);
  };

  return t;
}(document, "script", "twitter-wjs"));
</script>

  </section>
</div>


  
    
<section class="article-comment">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>

<script>
  var disqus_shortname = 'drakeleung';
  
  var disqus_url = 'http://drakeleung.github.io/blog/2015/07/25/BFC-in-CSS-0-WTF/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


  
</main>

</body>
</html>
